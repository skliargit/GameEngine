/*
    @file thread.h
    @brief Кросс-платформенный интерфейс для работы с потоками.
    @author Дмитрий Скляр.
    @version 1.0
    @date 23-08-2025

    @license Лицензия Apache, версия 2.0 («Лицензия»);
          Вы не имеете права использовать этот файл без соблюдения условий Лицензии.
          Копию Лицензии можно получить по адресу http://www.apache.org/licenses/LICENSE-2.0
          Если иное не предусмотрено действующим законодательством или не согласовано в письменной форме,
          программное обеспечение, распространяемое по Лицензии, распространяется на условиях «КАК ЕСТЬ»,
          БЕЗ КАКИХ-ЛИБО ГАРАНТИЙ ИЛИ УСЛОВИЙ, явных или подразумеваемых. См. Лицензию для получения
          информации о конкретных языках, регулирующих разрешения и ограничения по Лицензии.

    @note Реализации функций являются платформозависимыми и находятся в соответствующих
          platform/ модулях (windows, linux и т.д.).

    @note Для корректной работы необходимо предварительно инициализировать (в указанном порядке):
            - Подсистему консоли platform_console_initialize()
            - Подсистему потоков platform_thread_initialize()
*/

#pragma once

#include <core/defines.h>

/*
    @brief Инициализирует подсистему для работы с потоками.
    @note Должна быть вызвана один раз при старте приложения.
    @warning Не thread-safe. Должна вызываться из основного потока.
    @return true - инициализация успешна, false - произошла ошибка.
*/
API bool platform_thread_initialize();

/*
    @brief Завершает работу подсистемы для работы с потоками.
    @note Должна быть вызвана при завершении приложения, после завершения всех потоков.
    @warning Не thread-safe. Должна вызываться из основного потока.
*/
API void platform_thread_shutdown();

/*
    @brief Проверяет, была ли инициализирована подсистема для работы с потоками.
    @note Может использоваться для проверки состояния подсистемы перед вызовом других функций.
    @warning Не thread-safe. Должна вызываться из того же потока, что и инициализация/завершение.
    @return true - подсистема инициализирована и готова к работе, false - подсистема не инициализирована.
*/
API bool platform_thread_is_initialized();

/*
    @brief Приостанавливает выполнение текущего потока на заданное время.
    @note Thread-safe, может вызываться любым потоком без последствий.
    @note Точность приостановки зависит от планировщика операционной системы.
    @param time_ms Время приостановки в миллисекундах. Должно быть больше 0.
    @return true - приостановка успешно завершена, false - произошла ошибка.
*/
API bool platform_thread_sleep(u32 time_ms);

/*
    @brief Создает новый поток выполнения.
    @param func Функция-исполнитель потока.
    @param data Данные для передачи в функцию-исполнитель.
    @return Идентификатор созданного потока или 0 при ошибке.
*/
// API thread_id platform_thread_create(thread_func func, void* data);

/*
    @brief Ожидает завершения указанного потока.
    @param thread_id Идентификатор потока для ожидания.
    @return Код возврата потока или -1 при ошибке.
*/
// API i32 platform_thread_join(thread_id thread_id);
