#pragma once

#include <core/defines.h>

/*
    @brief Получает количество символов в строке (без учета завершающего нуль-символа).
    @note Поддерживаются строки в кодировках ANSI/ASCII. Для UTF-8 используйте специальные функции.
    @param str Указатель на нуль-терминированную строку.
    @return Количество символов в строке.
*/
API u64 platform_string_length(const char* str);

/*
    @brief Вычисляет длину отформатированной строки без фактического форматирования.
    @note Функция полезна для предварительного определения размера буфера.
    @param format Строка формата в стиле printf. Не может быть nullptr.
    @param args Указатель на список аргументов переменной длины (va_list).
    @return Длина результирующей строки (без учета завершающего нуль-символа) или -1 в случае ошибки.
*/
API i32 platform_string_format_length(const char* format, void* args);

/*
    @brief Форматирует строку с использованием указателя на списк аргументов переменной длины.
    @note Для безопасного использования убедитесь, что dst достаточно велик для хранения результата.
    @param dst Буфер для записи результата. Не может быть nullptr.
    @param length Размер буфера dst, включая место для завершающего нуль-символа.
    @param format Строка формата в стиле printf. Не может быть nullptr.
    @param args Указатель на список аргументов переменной длины (va_list).
    @return Количество записанных символов (без учета завершающего нуль-символа) или -1 в случае ошибки.
*/
API i32 platform_string_format_va(char* dst, u64 length, const char* format, void* args);

/*
    @brief Форматирует строку с переменным числом аргументов.
    @note Для безопасного использования убедитесь, что dst достаточно велик для хранения результата.
    @param dst Буфер для записи результата. Не может быть nullptr.
    @param length Размер буфера dst, включая место для завершающего нуль-символа.
    @param format Строка формата в стиле printf. Не может быть nullptr.
    @param ... Аргументы для подстановки в строку формата.
    @return Количество записанных символов (без учета завершающего нуль-символа) или -1 в случае ошибки.
*/
API i32 platform_string_format(char* dst, u64 length, const char* format, ...);

/*
    @brief Сравнивает две нуль-терминированные строки с учетом регистра.
    @note Сравнение чувствительно к регистру.
    @param lstr Указатель на первую строку (должна быть валидной).
    @param rstr Указатель на вторую строку (должна быть валидной).
    @return true если строки идентичны, false если различны или переданы nullptr указатели.
*/
API bool platform_string_equal(const char* lstr, const char* rstr);

/*
    @brief Сравнивает две нуль-терминированные строки без учета регистра.
    @note Сравнение не чувствительно к регистру.
    @param lstr Указатель на первую строку (должна быть валидной).
    @param rstr Указатель на вторую строку (должна быть валидной).
    @return true если строки идентичны (игнорируя регистр), false если различны или переданы nullptr указатели.
*/
API bool platform_string_equali(const char* lstr, const char* rstr);

/*
    @brief Сравнивает первые N символов двух строк с учетом регистра.
    @note Если строка короче указанной длины, сравнение завершится на первом нуль-терминаторе.
    @param lstr Указатель на первую строку.
    @param rstr Указатель на вторую строку.
    @param length Количество символов для сравнения, если length = 0, строки считаются равными.
    @return true если указанные части строк идентичны, false если различны или переданы nullptr указатели.
*/
API bool platform_string_nequal(const char* lstr, const char* rstr, u64 length);

/*
    @brief Сравнивает первые N символов двух строк без учета регистра.
    @note Если строка короче указанной длины, сравнение завершится на первом нуль-терминаторе.
    @param lstr Указатель на первую строку.
    @param rstr Указатель на вторую строку.
    @param length Количество символов для сравнения, если length = 0, строки считаются равными.
    @return true если указанные части строк идентичны (игнорируя регистр), false если различны или переданы nullptr указатели.
*/
API bool platform_string_nequali(const char* lstr, const char* rstr, u64 length);

/*
    @brief Копирует нуль-терминированную строку.
    @note Копируется вся строка включая нуль-терминатор.
    @warning Вызывающая сторона должна обеспечить достаточный размер буфера назначения.
    @param dst Указатель на буфер назначения (должен быть достаточно большим).
    @param src Указатель на строку-источник.
    @return Указатель на буфер назначения (dest).
*/
API char* platform_string_copy(char* dst, const char* src);

/*
    @brief Копирует не более N символов строки и добавляет нуль терминатор.
    @note Если длина src меньше length, копируется вся строка включая нуль-терминатор.
    @warning Вызывающая сторона должна обеспечить достаточный размер буфера назначения.
    @param dst Указатель на буфер назначения (должен быть достаточно большим).
    @param src Указатель на строку-источник.
    @param length Максимальное количество символов для копирования (включая нуль-терминатор).
    @return Указатель на буфер назначения (dest).
*/
API char* platform_string_ncopy(char* dst, const char* src, u64 length);
